<!DOCTYPE html>
<html lang="en">
<head>
    <%- include('../partials/head'); %>
    <title>Test Results for <%= user.first_name %> <%= user.last_name %></title>
</head>
<body>
    <div class="container">
        <h1>Test Results for <%= user.first_name %> <%= user.last_name %></h1>
        <p>Quiz: <%= quiz.title %></p>

        <% quizResults.forEach((result, index) => { %>
            <h3>Attempt <%= quizResults.length - index %></h3>
            <p>Score: <%= result.score %> / <%= totalScore %> points</p>
            <p>Submitted At: <%= new Date(result.submittedAt).toLocaleString() %></p>
            
            <table class="table table-bordered mt-3">
                <thead>
                    <tr>
                        <th>Question</th>
                        <th>Your Answer</th>
                        <th>Correct</th>
                    </tr>
                </thead>
                <tbody>
                    <% result.answers.forEach(answer => { %>
                        <tr>
                            <td><%= answer.questionText %></td>
                            <td style="color: <%= answer.isCorrect ? 'black' : 'red' %>;">
                                <%= answer.userAnswer %>
                            </td>
                            <td><%= answer.isCorrect ? 'Yes' : 'No' %></td>
                        </tr>
                    <% }) %>
                </tbody>
            </table>
        <% }) %>
        
        <a href="/admin/overallSummary/<%= quiz._id %>" class="btn btn-secondary">Back to Overall Summary</a>
    </div>
</body>
</html>
